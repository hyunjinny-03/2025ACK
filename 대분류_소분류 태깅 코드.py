import pandas as pd

# CSV 파일 불러오기
df = pd.read_csv('preprocessing_of_benefit.csv', encoding='utf-8')

# 대분류 카테고리
large_category = {
    "공연/전시": [
        "전시", "공연", "경기", "예술", "음악", "콘서트", "페스티벌", "문화", "연극", "뮤지컬", "오페라", "전시회",
        "전시장", "공연장", "예술의전당", "영화", "영화관", "CGV", "롯데시네마", "메가박스", "예매", "관람", "티켓",
        "티켓링크", "인터파크", "예스24", "스포츠", "프로야구", "프로축구", "HYBE INSIGHT", "Weverse Shop", "박물관",
        "미술관", "문화생활", "문화서비스", "갤러리", "뮤직페스티벌", "미술", "음악회", "연주회", "독서", "도서관",
        "문화센터", "미술용품", "미술학원", "문화누리카드", "문화상품권", "영화할인", "극장"
    ],
    "디저트": [
        "디저트", "카페", "커피", "음료", "제과", "제빵", "베이커리", "빵집", "케익", "아이스크림", "빙수", "도넛", "차",
        "스타벅스", "투썸플레이스", "이디야", "빽다방", "던킨", "배스킨라빈스", "파리바게뜨", "뚜레쥬르", "할리스", "탐앤탐스",
        "폴바셋", "공차", "설빙", "커피빈", "엔제리너스", "파스쿠찌", "크리스피크림", "베이글", "디저트카페", "음료전문점",
        "밀크티", "주스", "스무디", "케이크", "롤케익", "와플", "쿠키", "마카롱", "젤라또", "프라페", "라떼", "아메리카노",
        "바리스타", "카페라떼", "프랜차이즈카페"
    ],
    "생활서비스": [
        "주유", "주차", "세차", "택시", "버스", "지하철", "하이패스", "KTX", "SRT", "고속도로", "대중교통", "통신요금",
        "SKT", "KT", "LGU+", "알뜰폰", "아파트관리비", "전기료", "가스요금", "세탁", "이사", "청소", "주택관리",
        "렌탈", "정수기", "공기청정기", "비데", "여행사", "항공권", "호텔", "숙박", "환전", "송금", "대출", "보험", "정비",
        "자동차보험", "렌터카", "마사지", "사우나", "미용실", "네일", "피부관리", "포인트", "캐시백", "무이자할부", "바우처",
        "쿠폰", "상품권", "페이", "간편결제", "모바일결제", "PAYCO", "삼성페이", "카카오페이", "네이버페이", "토스", "PAY",
        "카드할인", "카드적립", "전월실적", "할인율", "적립률", "수수료", "금융", "예금", "적금", "CMA", "증권", "은행",
        "ATM", "인터넷뱅킹", "모바일뱅킹", "국민카드", "신한카드", "삼성카드", "현대카드", "하나카드", "롯데카드", "우리은행",
        "하나은행", "국민은행", "신한은행", "농협", "마일리지", "항공마일리지", "주택관리비", "통신비", "대중교통비"
    ],
    "소매/유통": [
        "쇼핑", "마트", "백화점", "편의점", "홈쇼핑", "온라인쇼핑", "오프라인", "마켓", "스토어", "아울렛", "면세점",
        "전자상거래", "쿠팡", "11번가", "G마켓", "옥션", "위메프", "티몬", "SSG", "네이버쇼핑", "올리브영", "다이소",
        "무신사", "H&M", "유니클로", "의류", "잡화", "화장품", "식품", "생활용품", "가전", "가구", "인테리어", "서적",
        "문구", "완구", "건강식품", "스포츠용품", "명품", "해외직구", "직구", "아마존", "알리", "이베이", "종합몰",
        "이마트", "롯데마트", "홈플러스", "GS25", "CU", "세븐일레븐", "미니스톱", "롯데백화점", "신세계백화점", "현대백화점",
        "갤러리아", "ak플라자", "홈플러스익스프레스", "이마트에브리데이", "코스트코", "트레이더스", "프리미엄아울렛", "면세점",
        "뷰티", "드럭스토어", "슈퍼마켓", "유통", "판매", "쿠폰", "적립금", "할인", "세일", "신발", "가방", "액세서리",
        "주얼리", "명품관", "편집샵"
    ],
    "식사": [
        "음식점", "외식", "배달", "배달앱", "배달의민족", "요기요", "쿠팡이츠", "한식", "중식", "일식", "양식",
        "패스트푸드", "피자", "치킨", "분식", "고기", "스테이크", "부페", "샐러드", "아웃백", "빕스", "KFC",
        "맥도날드", "롯데리아", "버거킹", "맘스터치", "프랜차이즈", "맛집", "식당", "술집", "주점", "삼겹살", "초밥", "파스타",
        "스시", "샐러디", "본죽", "순대", "김밥", "라면", "족발", "보쌈", "회", "이자카야", "중국집", "한식뷔페",
        "샤브샤브", "감자탕", "해장국", "떡볶이", "샌드위치", "햄버거", "레스토랑", "패밀리레스토랑", "식사권", "식대"
    ],
    "여가/오락": [
        "여가", "오락", "취미", "게임", "스트리밍", "OTT", "넷플릭스", "웨이브", "유튜브 프리미엄", "골프", "헬스",
        "피트니스", "수영장", "테니스", "요가", "놀이공원", "테마파크", "롯데월드", "에버랜드", "워터파크", "오락실",
        "노래방", "PC방", "팬덤", "Weverse", "여행", "숙박", "항공", "호텔", "콘도", "캠핑", "스키장", "보드", "스포츠",
        "볼링", "당구", "낚시", "등산", "영화", "영화예매", "게임캐시", "인앱결제", "유료결제", "여행상품", "호텔예약",
        "항공권예약", "레저", "취미생활", "클래스", "강좌", "공방", "마사지", "사우나", "스파"
    ],
    "의료/건강": [
        "병원", "의료", "건강", "약국", "건강검진", "의약품", "한의원", "치과", "피부과", "성형외과", "동물병원",
        "수의업", "반려동물", "보험", "요양원", "건강관리", "종합병원", "대학병원", "내과", "외과", "소아과", "안과",
        "산부인과", "정형외과", "통증클리닉", "재활치료", "건강식품", "영양제", "비타민", "홍삼", "건강보조식품", "운동시설"
    ],
    "전자상거래": [
        "온라인쇼핑", "인터넷쇼핑", "소셜커머스", "오픈마켓", "배달앱", "간편결제", "페이", "온라인", "모바일",
        "쿠팡", "네이버페이", "삼성페이", "카카오페이", "11번가", "G마켓", "옥션", "위메프", "티몬", "PAYCO",
        "SSG페이", "해외직구", "직구", "아마존", "알리익스프레스", "이베이", "쿠폰", "적립", "할인", "포인트", "모바일결제",
        "온라인결제", "온라인몰", "E-commerce"
    ]
}

# 소분류 카테고리
detail_category = {
    # 공연/전시
    "전시장": ["전시장", "전시", "전시회", "박물관", "미술관", "갤러리", "미술"],
    "공연관람": ["공연관람", "공연", "공연장", "뮤지컬", "연극", "오페라", "콘서트", "티켓", "티켓링크", "인터파크 티켓", "예스24 티켓", "Weverse Shop", "문화생활", "문화"],
    "경기관람": ["경기관람", "경기", "스포츠", "프로야구", "프로축구", "농구", "배구", "관람"],
    "문화서비스": ["문화서비스", "문화생활", "예술", "예술의전당", "예술제", "문화", "연주", "연주회", "독서", "도서관", "문화강좌"],

    # 디저트
    "제과/제빵/떡/케익": ["제과", "제빵", "떡", "케익", "베이커리", "빵집", "파리바게뜨", "뚜레쥬르", "던킨", "크리스피크림", "빙수", "도넛", "케이크", "롤케익", "와플", "쿠키", "마카롱"],
    "커피/음료": ["커피", "음료", "카페", "티", "밀크티", "스타벅스", "투썸플레이스", "이디야", "빽다방", "할리스", "폴바셋", "탐앤탐스", "공차", "설빙", "커피빈", "엔제리너스", "파스쿠찌", "음료전문점", "주스", "스무디", "프라페"],

    # 생활서비스
    "미용서비스": ["미용서비스", "미용실", "네일", "피부관리", "헤어", "뷰티", "마사지", "스파", "네일아트", "왁싱"],
    "전문서비스": ["전문서비스", "보험", "보험료", "금융", "캐시백", "포인트", "수수료", "바우처", "쿠폰", "상품권", "적립", "마일리지", "무이자할부", "예금", "적금", "CMA", "증권", "은행", "ATM", "인터넷뱅킹"],
    "부동산": ["부동산", "중개수수료", "임대료", "월세", "전세"],
    "사우나/휴게시설": ["사우나", "휴게시설", "찜질방", "목욕탕", "스파"],
    "세탁/가사서비스": ["세탁", "세탁소", "가사서비스", "가사도우미", "청소", "홈케어"],
    "수리서비스": ["수리서비스", "정비", "가전수리", "컴퓨터수리", "수리비", "정비소"],
    "연료판매": ["연료판매", "주유", "주유소", "충전소", "LPG", "휘발유", "경유", "SK에너지", "GS칼텍스", "현대오일뱅크", "S-oil", "알뜰주유소"],
    "차량관리/서비스": ["차량관리/서비스", "렌터카", "렌탈", "렌탈서비스", "차량정비", "세차", "주차", "발레파킹", "주차장"],
    "보안/운송": ["보안서비스", "보안", "택배", "운송", "화물", "이사"],
    "여행/유학대행": ["여행/유학대행", "여행사", "항공권", "호텔", "숙박", "환전", "하나투어", "모두투어"],
    "렌탈서비스": ["렌탈서비스", "정수기렌탈", "비데렌탈", "공기청정기렌탈"],
    "무점포서비스": ["무점포서비스", "방문판매", "직판"],
    "교통서비스": ["교통서비스", "대중교통", "택시", "버스", "지하철", "하이패스", "KTX", "SRT", "고속도로", "선불교통카드"],

    # 소매/유통
    "가전제품": ["가전제품", "가전", "소형가전", "삼성디지털프라자", "LG베스트샵", "하이마트", "TV", "냉장고", "세탁기", "에어컨", "노트북", "PC", "핸드폰"],
    "건강/기호식품": ["건강/기호식품", "건강식품", "영양제", "비타민", "홍삼", "일동후디스", "기호식품", "커피", "차", "음료"],
    "사무/교육용품": ["사무/교육용품", "문구", "알파문구", "펜", "노트", "학습지", "학용품"],
    "서적/도서": ["서적", "도서", "책", "교보문고", "영풍문고", "만화", "웹소설", "카카오페이지", "리디북스"],
    "선물/완구": ["완구", "선물", "인형", "장난감", "꽃집", "기타용품", "기프트"],
    "스포츠/레저용품": ["레저용품", "스포츠용품", "골프용품", "등산용품", "낚시용품", "스키용품", "스노우보드용품"],
    "유아용품": ["유아용품", "분유", "기저귀", "아동복", "유모차", "카시트", "장난감"],
    "음/식료품소매": ["음/식료품소매", "음식료품", "정육점", "수산물", "식품", "식료품", "농산물"],
    "의복/의류": ["의복", "의류", "의복/의류", "패션", "명품", "H&M", "유니클로", "자라", "아웃도어", "스포츠웨어"],
    "인테리어/가정용품": ["인테리어", "가정용품", "가구", "생활용품", "이케아", "오늘의집", "주방용품", "침구", "소품"],
    "종합소매점": ["종합소매점", "마트", "백화점", "슈퍼마켓", "면세점", "아울렛", "편의점", "롯데마트", "이마트", "홈플러스", "코스트코", "GS25", "CU", "세븐일레븐", "롯데백화점", "신세계백화점", "현대백화점", "갤러리아", "ak플라자", "홈플러스익스프레스", "이마트에브리데이", "트레이더스"],
    "차량관리/부품": ["차량관리/부품", "차량정비", "타이어", "엔진오일", "자동차부품", "스피드메이트", "타이어뱅크"],
    "차량판매": ["차량판매", "자동차구매", "중고차", "새차"],
    "악기/공예": ["악기/공예", "악기", "공예", "미술용품"],
    "패션잡화": ["패션잡화", "잡화", "가방", "신발", "시계", "주얼리", "액세서리"],
    "화장품소매": ["화장품소매", "화장품", "올리브영", "아리따움", "더페이스샵", "이니스프리"],

    # 식사
    "고기요리": ["고기요리", "고기", "삼겹살", "한우", "갈비", "정육식당", "소고기", "돼지고기"],
    "닭/오리고기": ["닭요리", "오리요리", "치킨"],
    "별식/퓨전요리": ["별식", "퓨전요리", "세계요리"],
    "부페": ["부페", "뷔페", "호텔뷔페", "샐러드바"],
    "분식": ["분식", "떡볶이", "순대", "김밥", "라면", "엽기떡볶이", "신전떡볶이", "죠스떡볶이", "분식집"],
    "양식": ["양식", "레스토랑", "파스타", "스테이크", "피자", "이탈리안", "프랑스요리"],
    "일식/수산물": ["일식", "수산물", "초밥", "횟집", "이자카야", "일식당", "참치", "회"],
    "중식": ["중식", "짜장면", "짬뽕", "중국집", "탕수육", "깐풍기"],
    "패스트푸드": ["패스트푸드", "햄버거", "맥도날드", "롯데리아", "버거킹", "맘스터치", "KFC", "샌드위치"],
    "한식": ["한식", "백반", "찌개", "국밥", "일반음식점", "요식업", "본죽", "샐러디", "순두부찌개", "김치찌개", "된장찌개", "해장국", "비빔밥"],
    "휴게소/대형업체": ["휴게소", "대형업체", "아웃백", "빕스", "TGI", "패밀리레스토랑", "애슐리", "자연별곡"],

    # 여가/오락
    "숙박": ["숙박", "호텔", "모텔", "콘도", "펜션", "에어비앤비"],
    "요가/단전/마사지": ["요가", "단전", "마사지", "필라테스", "스파", "테라피"],
    "일반스포츠": ["스포츠센터", "헬스", "피트니스", "수영장", "골프", "테니스", "요가", "볼링", "당구", "스크린골프"],
    "취미/오락": ["취미", "오락", "게임", "PC방", "노래방", "방탈출", "놀이공원", "테마파크", "롯데월드", "에버랜드", "워터파크", "오락실", "영화", "스트리밍", "OTT", "넷플릭스", "유튜브 프리미엄", "Weverse"],

    # 의료/건강
    "수의업": ["수의업", "동물병원", "동물 약국", "반려동물보험"],
    "의약/의료품": ["의약", "의약품", "약국", "건강", "의료품", "보건소"],
    "일반병원": ["병원", "일반병원", "내과", "외과", "소아과"],
    "특화병원": ["특화병원", "치과", "피부과", "성형외과", "정형외과", "안과", "산부인과"],
    "종합병원": ["종합병원", "대학병원"],

    # 전자상거래
    "인터넷쇼핑": ["인터넷쇼핑", "온라인쇼핑", "온라인", "모바일", "해외직구", "아마존", "알리익스프레스", "이베이", "네이버쇼핑", "SSG닷컴", "쿠팡", "11번가", "지마켓", "옥션"],
    "음식배달서비스": ["배달앱", "음식배달", "배달의민족", "요기요", "쿠팡이츠"]
}

# 대분류 태깅 함수
def tag_benefits_by_large(text):
    tags = set()
    for category, keywords in large_category.items():
        if any(keyword in str(text) for keyword in keywords):
            tags.add(category)
    return list(tags)

# 소분류 태깅 함수
def tag_benefits_by_detail(text):
    tags = set()
    for detail, keywords in detail_category.items():
        if any(keyword in str(text) for keyword in keywords):
            tags.add(detail)
    return list(tags)

# 대분류 태그
df['대분류태그'] = df['통합혜택'].apply(tag_benefits_by_large)

# 소분류 태그
df['소분류태그'] = df['통합혜택'].apply(tag_benefits_by_detail)

# 확인
print(df[['카드명_x', '대분류태그', '소분류태그']].head())

# 저장
df.to_csv('tagging_of_benefit.csv', index=False, encoding='utf-8-sig')
